<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ­å¹Œæ»‘é›ªä¹‹æ—…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=places"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --hokkaido-blue: #3b9fd9;
            --hokkaido-light: #e8f4f8;
            --hokkaido-dark: #0f4c6b;
            --snow-white: #f8fafb;
        }

        body {
            background: linear-gradient(180deg, #e8f4f8 0%, #f0f8fb 100%);
            font-family: 'Noto Sans CJK JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: #2c3e50;
        }

        .banner-container {
            position: relative;
            height: 250px;
            overflow: hidden;
            background: linear-gradient(135deg, #3b9fd9 0%, #5eb3e6 100%);
        }

        .banner-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .curved-container {
            background-color: var(--snow-white);
            border-radius: 40px 40px 0 0;
            margin-top: -35px;
            position: relative;
            z-index: 10;
            padding-top: 35px;
        }

        .tab-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 12px;
            z-index: 50;
        }

        .tab-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid var(--hokkaido-blue);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 159, 217, 0.2);
        }

        .tab-btn:hover {
            background: var(--hokkaido-blue);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(59, 159, 217, 0.4);
        }

        .tab-btn.active {
            background: var(--hokkaido-blue);
            color: white;
        }

        /* æ—¥æœŸé¸å–®æ»‘å‹• */
        .date-scroll {
            display: flex;
            gap: 6px;
            overflow-x: auto;
            padding: 16px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        .date-scroll::-webkit-scrollbar {
            height: 6px;
        }

        .date-scroll::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 3px;
        }

        .date-scroll::-webkit-scrollbar-thumb {
            background: var(--hokkaido-blue);
            border-radius: 3px;
        }

        .date-item {
            min-width: 40px;
            padding: 10px 10px;
            border-radius: 20px;
            background: white;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .date-item:hover {
            border-color: var(--hokkaido-blue);
            transform: translateY(-2px);
        }

        .date-item.active {
            background: var(--hokkaido-blue);
            color: white;
            border-color: var(--hokkaido-blue);
        }

        .date-week {
            font-size: 14px;
            font-weight: 600;
            line-height: 1.2;
        }

        .date-day {
            font-size: 18px;
            font-weight: 700;
            line-height: 1.2;
        }

        /* è¡Œç¨‹å¡ç‰‡ */
        .itinerary-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            border-left: 4px solid var(--hokkaido-blue);
            cursor: grab;
            transition: all 0.3s ease;
        }

        .itinerary-card:active {
            cursor: grabbing;
            opacity: 0.9;
        }

        .itinerary-card:hover {
            box-shadow: 0 4px 16px rgba(59, 159, 217, 0.15);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .card-icon {
            font-size: 28px;
            min-width: 32px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--hokkaido-dark);
            flex: 1;
        }

        .card-time {
            font-size: 14px;
            color: var(--hokkaido-blue);
            font-weight: 600;
        }

        .card-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
        }

        .card-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .card-btn:hover {
            background: var(--hokkaido-blue);
            color: white;
        }

        .card-content {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
            margin-top: 8px;
        }

        .transit-info {
            background: linear-gradient(135deg, #e8f4f8 0%, #f0f8fb 100%);
            padding: 10px 12px;
            border-radius: 12px;
            margin: 12px 0;
            font-size: 12px;
            color: #444;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* æµ®å‹•æŒ‰éˆ• */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--hokkaido-blue);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 6px 20px rgba(59, 159, 217, 0.3);
            transition: all 0.3s ease;
            z-index: 15;
        }

        .fab:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(59, 159, 217, 0.4);
        }

        .fab:active {
            transform: scale(0.95);
        }

        /* æ¨¡æ…‹çª—å£ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: flex-end;
            z-index: 100;
        }

        .modal-content {
            background: white;
            border-radius: 20px 20px 0 0;
            width: 100%;
            max-width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 24px;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* è¡¨å–® */
        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--hokkaido-dark);
            margin-bottom: 6px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1.5px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--hokkaido-blue);
            background-color: #f0f8fb;
            box-shadow: 0 0 0 3px rgba(59, 159, 217, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn {
            padding: 12px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--hokkaido-blue);
            color: white;
            width: 100%;
            margin-top: 12px;
        }

        .btn-primary:hover {
            background: var(--hokkaido-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 159, 217, 0.3);
        }

        .btn-danger {
            background: #ff6b6b;
            color: white;
            width: 100%;
            margin-top: 8px;
        }

        .btn-danger:hover {
            background: #ff5252;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
            width: 100%;
            margin-top: 8px;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        /* å¤©æ°£è³‡è¨Š */
        .weather-card {
            background: linear-gradient(135deg, var(--hokkaido-blue) 0%, #5eb3e6 100%);
            color: white;
            padding: 16px;
            border-radius: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 12px rgba(59, 159, 217, 0.2);
        }

        .weather-main {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .weather-icon {
            font-size: 48px;
        }

        .weather-temp {
            font-size: 32px;
            font-weight: 700;
            line-height: 1;
        }

        .weather-detail {
            font-size: 12px;
            line-height: 1.6;
            opacity: 0.9;
        }

        /* æé†’äº‹é … */
        .reminder-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            color: #856404;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* èˆªç­è³‡è¨Šå¡ */
        .flight-info {
            background: linear-gradient(135deg, #f0f8fb 0%, #e8f4f8 100%);
            border-left: 4px solid var(--hokkaido-blue);
            padding: 14px;
            border-radius: 12px;
            margin-bottom: 12px;
            font-size: 13px;
        }

        .flight-route {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .flight-time {
            font-size: 12px;
            color: #666;
            line-height: 1.6;
        }

        /* è³¼ç‰©å¡ç‰‡ */
        .shopping-card {
            background: white;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .shopping-image {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            background: #f0f0f0;
            overflow: hidden;
            flex-shrink: 0;
        }

        .shopping-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .shopping-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .shopping-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--hokkaido-dark);
        }

        .shopping-actions {
            display: flex;
            gap: 8px;
        }

        /* èŠ±è²»åˆ—è¡¨ */
        .expense-row {
            background: white;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--hokkaido-blue);
        }

        .expense-left {
            flex: 1;
        }

        .expense-category {
            font-size: 12px;
            color: #999;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .expense-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--hokkaido-dark);
            margin-top: 2px;
        }

        .expense-amount {
            font-size: 16px;
            font-weight: 700;
            color: var(--hokkaido-blue);
        }

        /* åˆ†å¸³å¡ç‰‡ */
        .split-card {
            background: linear-gradient(135deg, #e8f4f8 0%, #f0f8fb 100%);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
            border-left: 4px solid var(--hokkaido-blue);
        }

        .split-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 13px;
        }

        .split-detail {
            font-size: 12px;
            color: #666;
            line-height: 1.6;
        }

        /* è³‡è¨Šåˆ†é¡ */
        .info-section {
            margin-bottom: 20px;
        }

        .info-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--hokkaido-dark);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--hokkaido-blue);
        }

        .info-card {
            background: white;
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .info-label {
            font-size: 12px;
            color: #999;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 14px;
            color: #2c3e50;
            font-weight: 500;
            word-break: break-word;
        }

        /* åŒ¯ç‡æ›ç®— */
        .exchange-card {
            background: linear-gradient(135deg, var(--hokkaido-blue) 0%, #5eb3e6 100%);
            color: #ffffff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .exchange-input {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  margin-bottom: 12px;
  background-color: #ffffff;      /* è¼¸å…¥æ¡†åº•è‰² */
  color: #0c4a6e;                 /* ä½¿ç”¨è€…è¼¸å…¥çš„å­—é¡è‰²ï¼ˆæ·±è—ç¶ ï¼‰ */
}

/* æç¤ºæ–‡å­—ã€Œè¼¸å…¥é‡‘é¡ã€çš„é¡è‰²ï¼Œæ·¡ä¸€é» */
.exchange-input::placeholder {
  color: rgba(12, 74, 110, 0.4);  /* #0c4a6e åŠ é€æ˜åº¦çš„æ„Ÿè¦º */
}

        .exchange-result {
            font-size: 24px;
            font-weight: 700;
            line-height: 1.2;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .modal-content {
                padding: 20px;
                border-radius: 20px 20px 0 0;
            }

            .curved-container {
                padding-left: 16px;
                padding-right: 16px;
            }
        }

        /* é•·æŒ‰è¤‡è£½æç¤º */
        .copy-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--hokkaido-blue);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            z-index: 200;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            10%, 90% { opacity: 1; }
        }

        /* åœ°åœ–å®¹å™¨ */
        .map-container {
            width: 100%;
            height: 300px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .map-link {
            color: var(--hokkaido-blue);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
        }

        .map-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- é é¦– Banner -->
        <div class="banner-container">
            <img src="SKISB.jpg" alt="æœ­å¹Œæ»‘é›ªä¹‹æ—…" class="banner-image">

            <!-- Tab æŒ‰éˆ• -->
            <div class="tab-buttons">
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'itinerary' }"
                    @click="currentTab = 'itinerary'"
                    title="æ¯æ—¥è¡Œç¨‹è¡¨"
                >
                    ğŸ“
                </button>
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'info' }"
                    @click="currentTab = 'info'"
                    title="è³‡è¨Š"
                >
                    â„¹ï¸
                </button>
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'shopping' }"
                    @click="currentTab = 'shopping'"
                    title="è³¼ç‰©æ¸…å–®"
                >
                    ğŸ›’
                </button>
                <button 
                    class="tab-btn" 
                    :class="{ active: currentTab === 'expense' }"
                    @click="currentTab = 'expense'"
                    title="èŠ±è²»"
                >
                    ğŸ’°
                </button>
            </div>
        </div>

        <!-- ä¸»å…§å®¹å€åŸŸ -->
        <div class="curved-container">
            <!-- æ¯æ—¥è¡Œç¨‹è¡¨ -->
            <div v-show="currentTab === 'itinerary'" class="px-4 pb-20">
                <!-- æ—¥æœŸé¸å–® -->
                <div class="date-scroll">
                    <div 
                        v-for="date in dates" 
                        :key="date.id"
                        class="date-item"
                        :class="{ active: selectedDate === date.id }"
                        @click="selectedDate = date.id"
                    >
                        <div class="date-week">{{ date.week }}</div>
                        <div class="date-day">{{ date.day }}</div>
                    </div>
                </div>

                <!-- è¡Œç¨‹åˆ†é¡ä¸‹æ‹‰é¸å–® -->
                <div class="px-4 mt-4">
                    <select v-model="selectedCategory" class="form-select">
                        <option value="">å…¨éƒ¨åˆ†é¡</option>
                        <option value="flight">èˆªç­</option>
                        <option value="accommodation">ä½å®¿</option>
                        <option value="transportation">äº¤é€š</option>
                        <option value="attraction">æ™¯é»</option>
                        <option value="food">ç¾é£Ÿ</option>
                        <option value="shopping">è³¼ç‰©</option>
                        <option value="other">å…¶ä»–</option>
                    </select>
                </div>

                <!-- å¤©æ°£è³‡è¨Š -->
                <div class="px-4 mt-4" v-if="currentDayWeather">
                    <div class="weather-card">
                        <div class="weather-main">
                            <div class="weather-icon">{{ currentDayWeather.icon }}</div>
                            <div class="weather-temp">{{ currentDayWeather.temp }}Â°C</div>
                        </div>
                        <div class="weather-detail">
                            <div>é«”æ„Ÿæº«åº¦: {{ currentDayWeather.feelsLike }}Â°C</div>
                            <div>æ—…è¡Œå»ºè­°: {{ currentDayWeather.suggestion }}</div>
                            <div>ç©¿è¡£å»ºè­°: {{ currentDayWeather.clothingSuggestion }}</div>
                        </div>
                    </div>
                </div>

                <!-- è¡Œç¨‹åˆ—è¡¨ -->
                <div class="px-4 mt-4">
                    <!-- ç¬¬ä¸€å¤©èˆªç­è³‡è¨Š -->
                    <div v-if="selectedDate === 'day1'" class="mb-4">
                        <div v-for="flight in flightInfo.outbound" :key="flight.id" class="flight-info">
                            <div class="flight-route">
                                <span>{{ flight.departure }} â†’ {{ flight.arrival }}</span>
                                <span>{{ flight.flightNumber }}</span>
                            </div>
                            <div class="flight-time">
                                <div>å‡ºç™¼: {{ flight.departureTime }} | æŠµé”: {{ flight.arrivalTime }}</div>
                                <div>é£›è¡Œæ™‚é–“: {{ flight.duration }}</div>
                            </div>
                        </div>
                    </div>

                    <!-- è¡Œç¨‹å¡ç‰‡ -->
                    <div 
                        v-for="(item, index) in filteredItinerary"
                        :key="item.id"
                        class="itinerary-card"
                        draggable="true"
                        @dragstart="dragStart($event, index)"
                        @dragover.prevent
                        @drop="dragDrop($event, index)"
                        @dragend="dragEnd"
                        @longpress="copyToClipboard(item)"
                    >
                        <div class="card-header">
                            <div class="card-icon">{{ getCategoryIcon(item.category) }}</div>
                            <div>
                                <div class="card-title">{{ item.name }}</div>
                                <div class="card-time">{{ item.time }}</div>
                            </div>
                            <div class="card-actions">
                                <button class="card-btn" @click="editItem(item)">âœï¸</button>
                                <button class="card-btn" @click="deleteItem(item.id)">ğŸ—‘ï¸</button>
                            </div>
                        </div>

                        <div class="card-content">
                            <div v-if="item.hours">â° {{ item.hours }}</div>
                            <div v-if="item.ticket">ğŸ« é–€ç¥¨: {{ item.ticket }}</div>
                            <div v-if="item.notes">ğŸ“ {{ item.notes }}</div>
                        </div>

                        <!-- äº¤é€šæ™‚é–“ -->
                        <div v-if="index < filteredItinerary.length - 1" class="transit-info">
                            <span>{{ getTransitIcon(item.transit) }}</span>
                            <span>åˆ°ä¸‹ä¸€å€‹åœ°é»: {{ item.transitTime }}</span>
                        </div>

                        <div class="reminder-box">
                            âœ“ å‡ºé–€å‰: æ‰‹æ©Ÿ Â· éŒ¢åŒ… Â· æ—¥å¹£ Â· è­·ç…§ Â· æ‰‹å¥—
                        </div>
                    </div>

                    <!-- æœ€å¾Œä¸€å¤©èˆªç­è³‡è¨Š -->
                    <div v-if="selectedDate === 'day6'" class="mt-4">
                        <div v-for="flight in flightInfo.return" :key="flight.id" class="flight-info">
                            <div class="flight-route">
                                <span>{{ flight.departure }} â†’ {{ flight.arrival }}</span>
                                <span>{{ flight.flightNumber }}</span>
                            </div>
                            <div class="flight-time">
                                <div>å‡ºç™¼: {{ flight.departureTime }} | æŠµé”: {{ flight.arrivalTime }}</div>
                                <div>é£›è¡Œæ™‚é–“: {{ flight.duration }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æµ®å‹•æ–°å¢æŒ‰éˆ• -->
                <button class="fab" @click="openAddModal('itinerary')">+</button>
            </div>

            <!-- è³‡è¨Šé é¢ -->
            <div v-show="currentTab === 'info'" class="px-4 py-4 pb-20">
                <!-- åŒ¯ç‡æ›ç®— -->
                <div class="info-section">
                    <div class="exchange-card">
                        <div style="font-size: 12px; margin-bottom: 8px; opacity: 0.9;">æ—¥å¹£ (JPY) è½‰å°å¹£ (TWD)</div>
                        <input 
                            v-model.number="exchangeInput"
                            type="number"
                            inputmode="decimal"
                            placeholder="è¼¸å…¥é‡‘é¡"
                            class="exchange-input"
                        >
                        <div class="exchange-result">
                        NT$ {{ exchangeInput ? (Number(exchangeInput) * exchangeRate).toFixed(0) : '0' }}
                              </div>
                            <div style="font-size: 9px; margin-top: 8px; opacity: 0.8;color: #0c4a6e;">
                          åŒ¯ç‡: 1 JPY = {{ exchangeRate.toFixed(4) }} TWD
                      </div>
                    </div>
                </div>

                <!-- èˆªç­è³‡è¨Š -->
                <div class="info-section">
                    <h3 class="info-title">âœˆï¸ èˆªç­è³‡è¨Š</h3>

                    <!-- å»ç¨‹ -->
                    <div style="margin-bottom: 16px;">
                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--hokkaido-dark);">å»ç¨‹</div>
                        <div v-for="flight in flightInfo.outbound" :key="flight.id" class="info-card">
                            <div class="info-label">å‡ºç™¼åœ°</div>
                            <div class="info-value">{{ flight.departure }} ({{ flight.departureShort }})</div>
                            <div class="info-label" style="margin-top: 8px;">ç›®çš„åœ°</div>
                            <div class="info-value">{{ flight.arrival }} ({{ flight.arrivalShort }})</div>
                            <div class="info-label" style="margin-top: 8px;">èµ·é£›æ™‚é–“</div>
                            <div class="info-value">{{ flight.departureTime }}</div>
                            <div class="info-label" style="margin-top: 8px;">æŠµé”æ™‚é–“</div>
                            <div class="info-value">{{ flight.arrivalTime }}</div>
                            <div class="info-label" style="margin-top: 8px;">é£›è¡Œæ™‚é–“</div>
                            <div class="info-value">{{ flight.duration }}</div>
                            <div class="info-label" style="margin-top: 8px;">èˆªç­ç·¨è™Ÿ</div>
                            <div class="info-value">{{ flight.flightNumber }}</div>
                        </div>
                    </div>

                    <!-- å›ç¨‹ -->
                    <div>
                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--hokkaido-dark);">å›ç¨‹</div>
                        <div v-for="flight in flightInfo.return" :key="flight.id" class="info-card">
                            <div class="info-label">å‡ºç™¼åœ°</div>
                            <div class="info-value">{{ flight.departure }} ({{ flight.departureShort }})</div>
                            <div class="info-label" style="margin-top: 8px;">ç›®çš„åœ°</div>
                            <div class="info-value">{{ flight.arrival }} ({{ flight.arrivalShort }})</div>
                            <div class="info-label" style="margin-top: 8px;">èµ·é£›æ™‚é–“</div>
                            <div class="info-value">{{ flight.departureTime }}</div>
                            <div class="info-label" style="margin-top: 8px;">æŠµé”æ™‚é–“</div>
                            <div class="info-value">{{ flight.arrivalTime }}</div>
                            <div class="info-label" style="margin-top: 8px;">é£›è¡Œæ™‚é–“</div>
                            <div class="info-value">{{ flight.duration }}</div>
                            <div class="info-label" style="margin-top: 8px;">èˆªç­ç·¨è™Ÿ</div>
                            <div class="info-value">{{ flight.flightNumber }}</div>
                        </div>
                    </div>
                </div>

                <!-- ä½å®¿è³‡è¨Š -->
                <div class="info-section">
                    <h3 class="info-title">ğŸ¨ ä½å®¿è³‡è¨Š</h3>
                    <div class="info-card">
                        <div class="info-label">ä½å®¿åç¨±</div>
                        <div class="info-value">æœ­å¹Œè±å¹³å€ Airbnb åŒ…æ£Ÿ</div>
                        <div class="info-label" style="margin-top: 8px;">ä½ç½®</div>
                        <div class="info-value">å­¸åœ’å‰ç«™ (Gakuen-mae Station)</div>
                        <div class="info-label" style="margin-top: 8px;">Google Maps</div>
                        <a href="https://maps.app.goo.gl/FTicW2vcopkqsVCr7?g_st=ipc" target="_blank" class="map-link">
                            æŸ¥çœ‹åœ°åœ– â†’
                        </a>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #eee; font-size: 12px; color: #999;">
                            æœ€è¿‘è»Šç«™: å­¸åœ’å‰ç«™ (Gakuen-mae Station)<br>
                            <a href="https://maps.app.goo.gl/6zt4FdE7kAwhh6XY9?g_st=ipc" target="_blank" class="map-link">
                                åœ°éµç«™åœ°åœ– â†’
                            </a>
                        </div>
                    </div>
                </div>


                <!-- æ»‘é›ªå ´è³‡è¨Š -->
<div class="info-section">
  <h3 class="info-title">ğŸ¿ æ»‘é›ªå ´è³‡è¨Š</h3>
  <div class="info-card">
    <!-- åç¨± -->
    <div class="info-label">æ»‘é›ªå ´åç¨±</div>
    <div class="info-value">æœ­å¹Œæ‰‹ç¨»æ»‘é›ªå ´ (Sapporo Teine)</div>

    <!-- Google Maps é€£çµ -->
    <div class="info-label" style="margin-top: 8px;">Google Maps</div>
    <a
      href="https://maps.app.goo.gl/9Gt43ugFwwiRL96S9"
      target="_blank"
      class="map-link"
    >
      æŸ¥çœ‹æ»‘é›ªå ´åœ°åœ– â†’
    </a>

    <!-- å®˜æ–¹å³æ™‚å½±åƒ / é›ªé“ç‹€æ³ -->
    <div class="info-label" style="margin-top: 8px;">å®˜æ–¹å³æ™‚å½±åƒèˆ‡é›ªé“è³‡è¨Š</div>
    <a
      href="https://sapporo-teine.com/snow/gelande-report"
      target="_blank"
      class="map-link"
    >
      å³æ™‚å½±åƒãƒ»é›ªé“é–‹æ”¾ç‹€æ³ â†’
    </a>

    <!-- ç‡Ÿæ¥­æ™‚é–“ -->
    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #eee; font-size: 12px; color: #999;">
      æ‰‹ç¨»æ»‘é›ªå ´ç‡Ÿæ¥­æ™‚é–“ï¼š
      <br><br>
      å¥§æ—åŒ¹äºå€ æ–°æ‰‹å€ (Olympia Zone)ï¼š<br>
      â€§ æ—¥é–“ï¼š9:00 â€“ 16:00<br>
      â€§ å¤œæ»‘ï¼š16:00 â€“ 20:00ï¼ˆå¤œæ»‘é€šå¸¸åªåœ¨å¥§æ—åŒ¹äºå€ï¼‰
      <br><br>
      é«˜åœ°å€ (Highland Zone)ï¼š<br>
      â€§ æ—¥é–“ï¼š9:00 â€“ 16:00ï¼ˆé«˜åœ°å€ç´„ 15:30 é–‹å§‹é—œé–‰ï¼‰
    </div>
  </div>
</div>

                <!-- ç§Ÿè»Šè³‡è¨Š -->
                <div class="info-section">
                    <h3 class="info-title">ğŸš• åŒ…è»Šæ¥é€è³‡è¨Š</h3>
                    <div class="info-card">
                        <div style="margin-bottom: 10px;">
                            <div class="info-label">12/17 æ©Ÿå ´è‡³ä½å®¿</div>
                            <div class="info-value">Â¥70,000</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div class="info-label">12/18 ä½å®¿è‡³æ»‘é›ªå ´å¾€è¿”</div>
                            <div class="info-value">Â¥40,000</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div class="info-label">12/21 ä¸€æ—¥åŒ…è»Šè¡Œç¨‹</div>
                            <div class="info-value">Â¥60,000 (å„çµ„åˆ†é–‹çµå¸³)</div>
                        </div>
                        <div>
                            <div class="info-label">12/22 ä½å®¿è‡³æ©Ÿå ´</div>
                            <div class="info-value">Â¥40,000</div>
                        </div>
                    </div>
                </div>

                <!-- ç·Šæ€¥é†«ç™‚ -->
                <div class="info-section">
                    <h3 class="info-title">ğŸš¨ ç·Šæ€¥é†«ç™‚</h3>
                    <div class="info-card">
                        <div style="margin-bottom: 12px;">
                            <div class="info-label">æ—¥æœ¬è­¦å¯Ÿ</div>
                            <div class="info-value" style="font-weight: 700;">110</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div class="info-label">æ—¥æœ¬æ•‘è­·è»Š</div>
                            <div class="info-value" style="font-weight: 700;">119</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div class="info-label">æ—…æ—¥æµ·å¤–ç·Šæ€¥æ•‘åŠ©</div>
                            <div class="info-value">è«‹æ’¥æ‰“ç•¶åœ°è­¦å¯Ÿ 110 æˆ–æ•‘è­·è»Š 119</div>
                        </div>
                        <div>
                            <div class="info-label">å°ç£é§æ—¥æœ¬å¤§ä½¿é¤¨ (æœ­å¹Œåˆ†è™•)</div>
                            <div class="info-value">+81-11-641-1930</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è³¼ç‰©æ¸…å–® -->
            <div v-show="currentTab === 'shopping'" class="px-4 py-4 pb-20">
                <div v-if="shoppingList.length === 0" style="text-align: center; padding: 40px 0; color: #999;">
                    <div style="font-size: 48px; margin-bottom: 12px;">ğŸ›’</div>
                    <div>é‚„æ²’æœ‰è³¼ç‰©æ¸…å–®é …ç›®</div>
                </div>

                <div v-for="item in shoppingList" :key="item.id" class="shopping-card">
                    <div class="shopping-image">
                        <img v-if="item.image" :src="item.image" :alt="item.name">
                        <div v-else style="display: flex; align-items: center; justify-content: center; background: #f0f0f0; width: 100%; height: 100%;">
                            ğŸ“¸
                        </div>
                    </div>
                    <div class="shopping-info">
                        <div class="shopping-name">{{ item.name }}</div>
                        <div class="shopping-actions">
                            <button class="card-btn" @click="editItem(item)">âœï¸</button>
                            <button class="card-btn" @click="deleteItem(item.id)">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                </div>

                <button class="fab" @click="openAddModal('shopping')">+</button>
            </div>

            <!-- èŠ±è²»ç®¡ç† -->
            <div v-show="currentTab === 'expense'" class="px-4 py-4 pb-20">
                <!-- ç¸½èŠ±è²» -->
                <div style="background: linear-gradient(135deg, var(--hokkaido-blue) 0%, #5eb3e6 100%); color: white; padding: 20px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(59, 159, 217, 0.2);">
                    <div style="font-size: 12px; opacity: 0.9; margin-bottom: 6px;">ç¸½èŠ±è²»</div>
                    <div style="font-size: 32px; font-weight: 700;">Â¥ {{ totalExpense.toLocaleString() }}</div>
                </div>

                <!-- èŠ±è²»åˆ—è¡¨ -->
                <div style="margin-bottom: 16px;">
                    <h3 class="info-title">ğŸ’¸ æ”¯å‡ºæ˜ç´°</h3>
                    <div v-if="expenses.length === 0" style="text-align: center; padding: 30px; color: #999;">
                        é‚„æ²’æœ‰èŠ±è²»è¨˜éŒ„
                    </div>
                    <div v-for="expense in expenses" :key="expense.id" class="expense-row">
                        <div class="expense-left">
                            <div class="expense-category">{{ expense.category }}</div>
                            <div class="expense-name">{{ expense.name }}</div>
                            <div style="font-size: 12px; color: #999; margin-top: 4px;">{{ expense.date }}</div>
                        </div>
                        <div style="text-align: right;">
                            <div class="expense-amount">Â¥ {{ expense.amount.toLocaleString() }}</div>
                            <div style="font-size: 11px; color: #999; margin-top: 4px;">{{ expense.paymentMethod }}</div>
                        </div>
                    </div>
                </div>

                <!-- åˆ†å¸³ç³»çµ± -->
                <div>
                    <h3 class="info-title">ğŸ‘¥ åˆ†å¸³ç´€éŒ„</h3>
                    <div v-for="split in splits" :key="split.id" class="split-card">
                        <div class="split-header">
                            <span>{{ split.date }}</span>
                            <span>{{ split.people }}äººå¹³åˆ†</span>
                        </div>
                        <div class="split-detail">
                            <div>ğŸ“ {{ split.description }}</div>
                            <div style="margin-top: 6px;">ğŸ’µ {{ split.currency }}: {{ split.amount.toLocaleString() }}</div>
                            <div style="margin-top: 6px;">ğŸ‘¤ æ¯äºº: {{ (split.amount / split.people).toLocaleString() }} {{ split.currency }}</div>
                        </div>
                    </div>
                </div>

                <button class="fab" @click="openAddModal('expense')">+</button>
            </div>
        </div>

        <!-- ç·¨è¼¯/æ–°å¢æ¨¡æ…‹çª—å£ -->
        <div v-if="showModal" class="modal-overlay" @click.self="closeModal">
            <div class="modal-content">
                <button class="modal-close" @click="closeModal">âœ•</button>

                <!-- æ–°å¢/ç·¨è¼¯è¡Œç¨‹ -->
                <div v-if="modalType === 'itinerary'">
                    <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px; color: var(--hokkaido-dark);">
                        {{ editingItem ? 'ç·¨è¼¯è¡Œç¨‹' : 'æ–°å¢è¡Œç¨‹' }}
                    </h2>

                    <div class="form-group">
                        <label class="form-label">åˆ†é¡</label>
                        <select v-model="formData.category" class="form-select">
                            <option value="attraction">æ™¯é»</option>
                            <option value="accommodation">ä½å®¿</option>
                            <option value="food">ç¾é£Ÿ</option>
                            <option value="shopping">è³¼ç‰©</option>
                            <option value="flight">èˆªç­</option>
                            <option value="transportation">äº¤é€š</option>
                            <option value="other">å…¶ä»–</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">è¡Œç¨‹åç¨±</label>
                        <input v-model="formData.name" type="text" class="form-input" placeholder="è¼¸å…¥è¡Œç¨‹åç¨±">
                    </div>

                    <div class="form-group">
                        <label class="form-label">æ™‚é–“</label>
                        <input v-model="formData.time" type="time" class="form-input">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ç‡Ÿæ¥­æ™‚é–“ (é¸å¡«)</label>
                        <input v-model="formData.hours" type="text" class="form-input" placeholder="å¦‚: 10:00-18:00">
                    </div>

                    <div class="form-group">
                        <label class="form-label">é–€ç¥¨ (é¸å¡«)</label>
                        <input v-model="formData.ticket" type="text" class="form-input" placeholder="å¦‚: Â¥1,000">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ç‰¹è‰² & å‚™è¨»</label>
                        <textarea v-model="formData.notes" class="form-textarea" placeholder="è¼¸å…¥å‚™è¨»"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">äº¤é€šæ–¹å¼</label>
                        <select v-model="formData.transit" class="form-select">
                            <option value="walk">æ­¥è¡Œ</option>
                            <option value="car">é–‹è»Š</option>
                            <option value="transit">å¤§çœ¾é‹è¼¸</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">äº¤é€šæ™‚é–“</label>
                        <input v-model="formData.transitTime" type="text" class="form-input" placeholder="å¦‚: 15åˆ†é˜">
                    </div>

                    <button class="btn btn-primary" @click="saveItem">ä¿å­˜</button>

                    <div v-if="editingItem">
                        <button class="btn btn-danger" @click="confirmDelete">ç¢ºèªåˆªé™¤</button>
                        <button class="btn btn-secondary" @click="closeModal">å–æ¶ˆ</button>
                    </div>
                </div>

                <!-- æ–°å¢/ç·¨è¼¯è³¼ç‰©é …ç›® -->
                <div v-if="modalType === 'shopping'">
                    <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px; color: var(--hokkaido-dark);">
                        {{ editingItem ? 'ç·¨è¼¯è³¼ç‰©é …ç›®' : 'æ–°å¢è³¼ç‰©é …ç›®' }}
                    </h2>

                    <div class="form-group">
                        <label class="form-label">å•†å“åç¨±</label>
                        <input v-model="formData.name" type="text" class="form-input" placeholder="è¼¸å…¥å•†å“åç¨±">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ä¸Šå‚³åœ–ç‰‡</label>
                        <input 
                            type="file" 
                            accept="image/*"
                            @change="handleImageUpload"
                            class="form-input"
                            style="padding: 0;"
                        >
                    </div>

                    <button class="btn btn-primary" @click="saveItem">ä¿å­˜</button>

                    <div v-if="editingItem">
                        <button class="btn btn-danger" @click="confirmDelete">ç¢ºèªåˆªé™¤</button>
                        <button class="btn btn-secondary" @click="closeModal">å–æ¶ˆ</button>
                    </div>
                </div>

                <!-- æ–°å¢/ç·¨è¼¯èŠ±è²» -->
                <div v-if="modalType === 'expense'">
                    <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px; color: var(--hokkaido-dark);">
                        {{ editingItem ? 'ç·¨è¼¯èŠ±è²»' : 'æ–°å¢èŠ±è²»' }}
                    </h2>

                    <div class="form-group">
                        <label class="form-label">é¡åˆ¥</label>
                        <select v-model="formData.category" class="form-select">
                            <option value="transportation">äº¤é€š</option>
                            <option value="food">é£²é£Ÿ</option>
                            <option value="accommodation">ä½å®¿</option>
                            <option value="ticket">é–€ç¥¨</option>
                            <option value="shopping">è³¼ç‰©</option>
                            <option value="other">å…¶ä»–</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">åç¨±</label>
                        <input v-model="formData.name" type="text" class="form-input" placeholder="è¼¸å…¥èŠ±è²»åç¨±">
                    </div>

                    <div class="form-group">
                        <label class="form-label">æ—¥æœŸ</label>
                        <input v-model="formData.date" type="date" class="form-input">
                    </div>

                    <div class="form-group">
                        <label class="form-label">é‡‘é¡ (JPY)</label>
                        <input v-model.number="formData.amount" type="number" class="form-input" placeholder="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ä»˜æ¬¾æ–¹å¼</label>
                        <select v-model="formData.paymentMethod" class="form-select">
                            <option value="cash">ç¾é‡‘</option>
                            <option value="creditcard">ä¿¡ç”¨å¡</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">å‚™è¨»</label>
                        <textarea v-model="formData.notes" class="form-textarea" placeholder="è¼¸å…¥å‚™è¨»"></textarea>
                    </div>

                    <button class="btn btn-primary" @click="saveItem">ä¿å­˜</button>

                    <div v-if="editingItem">
                        <button class="btn btn-danger" @click="confirmDelete">ç¢ºèªåˆªé™¤</button>
                        <button class="btn btn-secondary" @click="closeModal">å–æ¶ˆ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- è¤‡è£½æç¤º -->
        <div v-if="showCopyToast" class="copy-toast">
            å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ âœ“
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    currentTab: 'itinerary',
                    selectedDate: 'day1',
                    selectedCategory: '',
                    showModal: false,
                    modalType: '',
                    editingItem: null,
                    editingIndex: -1,
                    showCopyToast: false,
                    exchangeInput: '',  // â† æ”¹æˆç©ºå­—ä¸²ï¼ˆè®“è¼¸å…¥æ¡†é–‹å§‹æ™‚æ˜¯ç©ºçš„ï¼‰
                    exchangeRate: 0.21, // 1 JPY = 0.2 TWD å·¦å³ (è«‹æ ¹æ“šç•¶æ—¥å¯¦éš›åŒ¯ç‡èª¿æ•´)
                    draggedIndex: -1,

                    // æ—¥æœŸåˆ—è¡¨
                    dates: [
                        { id: 'day1', week: 'Wed', day: '17' },
                        { id: 'day2', week: 'Thu', day: '18' },
                        { id: 'day3', week: 'Fri', day: '19' },
                        { id: 'day4', week: 'Sat', day: '20' },
                        { id: 'day5', week: 'Sun', day: '21' },
                        { id: 'day6', week: 'Mon', day: '22' }
                    ],

                    // èˆªç­è³‡è¨Š
                    flightInfo: {
                        outbound: [
                            {
                                id: 1,
                                departure: 'å°åŒ—æ¡ƒåœ’æ©Ÿå ´',
                                departureShort: 'TPE',
                                arrival: 'æœ­å¹Œæ–°åƒæ­²æ©Ÿå ´',
                                arrivalShort: 'CTS',
                                departureTime: '06:20',
                                arrivalTime: '10:55',
                                duration: 'ç´„4å°æ™‚35åˆ†',
                                flightNumber: 'è™èˆª'
                            },
                            {
                                id: 2,
                                departure: 'é«˜é›„å°æ¸¯æ©Ÿå ´',
                                departureShort: 'KHH',
                                arrival: 'æœ­å¹Œæ–°åƒæ­²æ©Ÿå ´',
                                arrivalShort: 'CTS',
                                departureTime: '11:05',
                                arrivalTime: '16:00',
                                duration: 'ç´„3å°æ™‚55åˆ†',
                                flightNumber: 'æ³°ç…èˆª SL392'
                            }
                        ],
                        return: [
                            {
                                id: 3,
                                departure: 'æœ­å¹Œæ–°åƒæ­²æ©Ÿå ´',
                                departureShort: 'CTS',
                                arrival: 'é«˜é›„å°æ¸¯æ©Ÿå ´',
                                arrivalShort: 'KHH',
                                departureTime: '17:00',
                                arrivalTime: '20:55',
                                duration: 'ç´„3å°æ™‚55åˆ†',
                                flightNumber: 'æ³°ç…èˆª SL393'
                            },
                            {
                                id: 4,
                                departure: 'æœ­å¹Œæ–°åƒæ­²æ©Ÿå ´',
                                departureShort: 'CTS',
                                arrival: 'å°åŒ—æ¡ƒåœ’æ©Ÿå ´',
                                arrivalShort: 'TPE',
                                departureTime: '11:55',
                                arrivalTime: '15:35',
                                duration: 'ç´„4å°æ™‚40åˆ†',
                                flightNumber: 'è™èˆª '
                            }
                        ]
                    },

                    // è¡Œç¨‹æ•¸æ“š
                    itineraryData: {
                        day1: [
                            { id: 1, category: 'other', name: 'å°åŒ—äººæ©Ÿå ´é›†åˆ', time: '03:20', hours: '', ticket: '', notes: 'è™èˆªå ±åˆ°ï¼Œèµ·é£›å‰3å°æ™‚', transit: 'walk', transitTime: '2å°æ™‚' },
                            { id: 2, category: 'flight', name: 'è™èˆªèµ·é£›', time: '06:20', hours: '', ticket: '', notes: 'å°åŒ—-æœ­å¹Œ', transit: 'transit', transitTime: '2å°æ™‚' },
                            { id: 3, category: 'other', name: 'é«˜é›„äººæ©Ÿå ´é›†åˆ', time: '08:55', hours: '', ticket: '', notes: 'æ³°ç…èˆªå ±åˆ°ï¼Œèµ·é£›å‰3å°æ™‚', transit: 'transit', transitTime: '' },
                            { id: 4, category: 'flight', name: 'æ³°ç…èˆªèµ·é£›', time: '11:05', hours: '', ticket: '', notes: 'é«˜é›„-æœ­å¹Œ', transit: 'transit', transitTime: '' },
                            { id: 5, category: 'transportation', name: 'æ©Ÿå ´æ¥æ©Ÿ', time: '18:00', hours: '', ticket: '', notes: 'é›†åˆé»æ­ä¹˜æ¥é§è»Š', transit: 'car', transitTime: '50åˆ†é˜' },
                            { id: 6, category: 'accommodation', name: 'æŠµé”ä½å®¿é»', time: '18:50', hours: '', ticket: '', notes: 'æœ­å¹Œè±å¹³å€ Airbnb åŒ…æ£Ÿ', transit: 'walk', transitTime: '10åˆ†é˜' },
                            { id: 7, category: 'shopping', name: 'ä½å®¿å‘¨é‚Šè¶…å¸‚æ¡è²·', time: '19:00', hours: '10:00-23:00', ticket: '', notes: 'è³¼è²·éš”å¤©æ—©é¤é£ŸæåŠæ—¥ç”¨å“', transit: 'walk', transitTime: '10åˆ†é˜' },
                            { id: 8, category: 'other', name: 'ç¡è¦º', time: '23:00', hours: '', ticket: '', notes: 'éš”å¤©è¦æ—©èµ·ä¸è¦å¤ªæ™šç¡', transit: '', transitTime: '' }
                        ],
                        day2: [
                            { id: 9, category: 'other', name: 'èµ·åºŠ + æ—©é¤', time: '07:00', hours: '', ticket: '', notes: 'å‰ä¸€æ—¥è¶…å¸‚è³¼ç‰©æ™‚è³¼å…¥', transit: 'walk', transitTime: '1å°æ™‚' },
                            { id: 10, category: 'transportation', name: 'æ•™ç·´æ¥é€å°ˆè»Š', time: '08:00', hours: '', ticket: '', notes: 'ä½å®¿é»è‡³æ‰‹ç¨»æ»‘é›ªå ´', transit: 'car', transitTime: '1å°æ™‚' },
                            { id: 11, category: 'attraction', name: 'æ»‘é›ªèª²ç¨‹', time: '09:00', hours: '09:00-15:00', ticket: '', notes: 'é›™æ¿3äºº/å–®æ¿6äºº/è‡ªç”±1äºº', transit: 'transit', transitTime: '30åˆ†é˜' },
                            { id: 12, category: 'food', name: 'æº«æ³‰åœ°æ”¾é¬†åƒé£¯æ³¡æ¹¯', time: '16:00', hours: '16:00-19:00', ticket: '', notes: 'æ•™ç·´è»Šæ¥é€åˆ°æº«æ³‰åœ°', transit: 'transit', transitTime: '1å°æ™‚15åˆ†' },
                            { id: 13, category: 'transportation', name: 'å›ç¨‹', time: '19:15', hours: '', ticket: '', notes: 'è¨ˆç¨‹è»Šâ†’è»Šç«™è½‰è»Š', transit: 'transit', transitTime: '50åˆ†é˜' },
                            { id: 14, category: 'accommodation', name: 'æŠµé”ä½å®¿é»', time: '20:10', hours: '', ticket: '', notes: '', transit: '', transitTime: '' }
                        ],
                        day3: [
                            { id: 15, category: 'attraction', name: 'å½ˆæ€§æ»‘é›ª (æ»‘é›ªçµ„)', time: '07:00', hours: '', ticket: '', notes: 'éƒé›¯/åº­éŠ˜7é»å‡ºç™¼ï¼Œæˆ–è‡ªè¡Œå®‰æ’å‡ºç™¼æ™‚é–“', transit: 'car', transitTime: '' },
                            { id: 16, category: 'shopping', name: 'è²å°è·¯/å¸‚å€é€›è¡— (è§€å…‰çµ„)', time: '09:00', hours: '', ticket: '', notes: 'è‡ªè¡Œå‰å¾€æœ­å¹Œå¸‚å€é€›è¡—', transit: 'transit', transitTime: '' }
                        ],
                        day4: [
                            { id: 17, category: 'attraction', name: 'æ»‘é›ª (æ»‘é›ªçµ„)', time: '07:00', hours: '', ticket: '', notes: 'éƒé›¯/åº­éŠ˜7é»å‡ºç™¼ï¼Œæˆ–è‡ªè¡Œå®‰æ’å‡ºç™¼æ™‚é–“', transit: 'car', transitTime: '' },
                            { id: 18, category: 'attraction', name: 'è‡ªè¡Œå®‰æ’è§€å…‰ (è§€å…‰çµ„)', time: '08:00', hours: '', ticket: '', notes: '', transit: 'transit', transitTime: '' }
                        ],
                        day5: [
                            { id: 19, category: 'attraction', name: 'å°æ¨½çµ„', time: '08:00', hours: '', ticket: '', notes: 'æ€¡æ…§ã€ç‘‹éŠ˜ã€å°‘å»·ã€æ‰¿å“²', transit: 'car', transitTime: '' },
                            { id: 20, category: 'attraction', name: 'ç™»åˆ¥æ´çˆºæ¹–çµ„', time: '08:00', hours: '', ticket: '', notes: 'éƒé›¯ã€åº­éŠ˜ã€æŸå‰ã€ä»¤å®‡ã€é˜¿ç¶­ã€ç¾ç²ã€‚å„è‡ªçµ„åˆ¥è¨è«–è¡Œç¨‹', transit: 'car', transitTime: '' }
                        ],
                        day6: [
                            { id: 21, category: 'other', name: 'é€€æˆ¿', time: '11:00', hours: '', ticket: '', notes: '', transit: 'car', transitTime: '15åˆ†é˜' },
                            { id: 22, category: 'shopping', name: 'æ©Ÿå ´è³¼ç‰©', time: '12:00', hours: '', ticket: '', notes: '6äººæ­ä¹˜åŒ…è»Šå‰å¾€æ©Ÿå ´', transit: 'car', transitTime: '3å°æ™‚' },
                            { id: 23, category: 'flight', name: 'è¾¦ç†å ±åˆ°æ‰‹çºŒ', time: '15:00', hours: '', ticket: '', notes: '', transit: 'walk', transitTime: '2å°æ™‚' },
                            { id: 24, category: 'flight', name: 'æ³°ç…èˆªé£›æ©Ÿèµ·é£›', time: '17:00', hours: '', ticket: '', notes: 'æœ­å¹Œ-é«˜é›„', transit: 'transit', transitTime: '' },
                            { id: 25, category: 'flight', name: 'æŠµé”é«˜é›„å°æ¸¯æ©Ÿå ´', time: '20:55', hours: '', ticket: '', notes: 'æ—…ç¨‹çµæŸ', transit: '', transitTime: '' }
                        ]
                    },

                    // è³¼ç‰©æ¸…å–®
                    shoppingList: [],

                    // èŠ±è²»åˆ—è¡¨
                    expenses: [],

                    // åˆ†å¸³ç³»çµ±
                    splits: [
                        {
                            id: 1,
                            date: '12/17',
                            people: 10,
                            description: 'å»ç¨‹åŒ…è»Šæ¥é€è²»ç”¨',
                            amount: 70000,
                            currency: 'JPY'
                        },
                        {
                            id: 2,
                            date: '12/18',
                            people: 3,
                            description: 'é›™æ¿æ»‘é›ªæ•™ç·´èª²',
                            amount: 70000,
                            currency: 'JPY'
                        },
                        {
                            id: 3,
                            date: '12/18',
                            people: 6,
                            description: 'å–®æ¿æ»‘é›ªæ•™ç·´èª²',
                            amount: 80000,
                            currency: 'JPY'
                        },
                        {
                            id: 4,
                            date: '12/18',
                            people: 10,
                            description: 'å¸‚å€è‡³æ»‘é›ªå ´æ¥é€è²»ç”¨',
                            amount: 40000,
                            currency: 'JPY'
                        },
                        {
                            id: 5,
                            date: '12/21',
                            people: 6,
                            description: 'ä¸€æ—¥åŒ…è»Šè¡Œç¨‹ (å°æ¨½/ç™»åˆ¥æ´çˆºæ¹–ï¼Œå„çµ„åˆ†é–‹çµå¸³)',
                            amount: 60000,
                            currency: 'NTD'
                        },
                        {
                            id: 6,
                            date: '12/22',
                            people: 6,
                            description: 'å›ç¨‹åŒ…è»Šæ¥é€è²»ç”¨',
                            amount: 40000,
                            currency: 'JPY'
                        }
                    ],

weatherData: {
  day1: {
    icon: 'â˜ï¸',
    temp: -2,
    feelsLike: -6,
    suggestion: 'å¤šé›²ä½æº«ï¼Œé©åˆè¼•é¬†é€›è¡—æˆ–ç§»å‹•æ—¥ï¼Œæˆ¶å¤–æ™‚é–“ä¸è¦å¤ªé•·',
    clothingSuggestion: 'åšç¾½çµ¨å¤–å¥—ã€ç™¼ç†±è¡£ã€é˜²é¢¨é•·è¤²ã€æ‰‹å¥—ã€å¸½å­'
  },

  day2: {
    icon: 'â˜ï¸',
    temp: -1,
    feelsLike: -5,
    suggestion: 'æŒçºŒå¤šé›²ï¼Œè·¯é¢å·²æœ‰ç©é›ªèˆ‡çµå†°ï¼Œèµ°è·¯è¦å°å¿ƒæ»‘å€’',
    clothingSuggestion: 'åšå¤–å¥—ã€é˜²æ»‘é´ã€æ‰‹å¥—ã€åœå·¾'
  },

  day3: {
    icon: 'ğŸŒ¨ï¸',
    temp: 4,
    feelsLike: 0,      // â† æ”¹é€™è£¡
    suggestion: 'é«˜æ©Ÿç‡é™é›ªæˆ–é›¨å¤¾é›ªï¼Œé©åˆæ»‘é›ªï¼Œä½†èƒ½è¦‹åº¦èˆ‡é›ªè³ªè¼ƒæ¿•é‡',
    clothingSuggestion: 'æ»‘é›ªæœã€é˜²æ°´é•·è¤²ã€é˜²æ°´æ‰‹å¥—ã€è­·ç›®é¡ã€ä¿æš–è¥ª'
  },

  day4: {
    icon: 'ğŸŒ§ï¸',
    temp: 8,
    feelsLike: 5,
    suggestion: 'ç™½å¤©ä»¥ä¸‹é›¨ç‚ºä¸»ï¼Œé›ªé“å®¹æ˜“è®Šæˆæ¿•é›ªèˆ‡çˆ›é›ªï¼Œæˆ¶å¤–æ´»å‹•è«‹æº–å‚™å®Œæ•´é˜²æ°´è£å‚™',
    clothingSuggestion: 'é˜²æ°´å¤–å¥—ã€é˜²æ°´é•·è¤²ã€é˜²æ°´é´ã€å‚™ç”¨è¥ªå­èˆ‡æ¯›å·¾'
  },

  day5: {
    icon: 'ğŸŒ¦ï¸',
    temp: 6,
    feelsLike: 4,
    suggestion: 'æŒçºŒå¤šé›²æœ‰é›¨ï¼Œé©åˆæ’å®¤å…§è¡Œç¨‹æˆ–çŸ­æ™‚é–“æ»‘é›ªå¾Œå›ä½å®¿ä¼‘æ¯',
    clothingSuggestion: 'è¼•é‡ç¾½çµ¨ï¼‹é˜²æ°´å¤–å±¤ã€é›¨å…·ã€é˜²æ°´é‹'
  },

  day6: {
    icon: 'â˜ï¸',
    temp: 0,
    feelsLike: -2,     // â† æ”¹é€™è£¡
    suggestion: 'è½‰å›ä¹¾å†·å¤šé›²å¤©æ°£ï¼Œé›ªæ³é€æ¼¸ç©©å®šï¼Œé©åˆæ•´ç†è¡Œææˆ–å¸‚å€æ´»å‹•',
    clothingSuggestion: 'åšå¤–å¥—ã€ç™¼ç†±è¡£ã€æ‰‹å¥—ã€æ¯›å¸½'
  }
}

                    // è¡¨å–®æ•¸æ“š
                    formData: {
                        category: 'attraction',
                        name: '',
                        time: '',
                        hours: '',
                        ticket: '',
                        notes: '',
                        transit: 'walk',
                        transitTime: '',
                        image: '',
                        date: new Date().toISOString().split('T')[0],
                        amount: 0,
                        paymentMethod: 'cash'
                    }
                };
            },

            computed: {
                filteredItinerary() {
                    const dayData = this.itineraryData[this.selectedDate] || [];
                    if (!this.selectedCategory) {
                        return dayData;
                    }
                    return dayData.filter(item => item.category === this.selectedCategory);
                },

                currentDayWeather() {
                    return this.weatherData[this.selectedDate];
                },

                totalExpense() {
                    return this.expenses.reduce((sum, expense) => sum + expense.amount, 0);
                }
            },

            methods: {
                getCategoryIcon(category) {
                    const icons = {
                        'attraction': 'ğŸ¯',
                        'accommodation': 'ğŸ¨',
                        'food': 'ğŸ½ï¸',
                        'shopping': 'ğŸ›ï¸',
                        'flight': 'âœˆï¸',
                        'transportation': 'ğŸš—',
                        'other': 'ğŸ“Œ'
                    };
                    return icons[category] || 'ğŸ“Œ';
                },

                getTransitIcon(transit) {
                    const icons = {
                        'walk': 'ğŸš¶',
                        'car': 'ğŸš—',
                        'transit': 'ğŸšŒ'
                    };
                    return icons[transit] || 'ğŸš—';
                },

                openAddModal(type) {
                    this.modalType = type;
                    this.editingItem = null;
                    this.editingIndex = -1;
                    this.resetForm();
                    this.showModal = true;
                },

                editItem(item) {
                    this.editingItem = item;
                    this.modalType = this.getModalType(item);

                    if (this.modalType === 'itinerary') {
                        const dayData = this.itineraryData[this.selectedDate];
                        this.editingIndex = dayData.findIndex(i => i.id === item.id);
                        this.formData = { ...item };
                    } else if (this.modalType === 'shopping') {
                        this.editingIndex = this.shoppingList.findIndex(i => i.id === item.id);
                        this.formData = { name: item.name, image: item.image };
                    } else if (this.modalType === 'expense') {
                        this.editingIndex = this.expenses.findIndex(i => i.id === item.id);
                        this.formData = { ...item };
                    }

                    this.showModal = true;
                },

                getModalType(item) {
                    if (item.category === undefined) return 'expense';
                    if (item.image !== undefined) return 'shopping';
                    return 'itinerary';
                },

                resetForm() {
                    this.formData = {
                        category: 'attraction',
                        name: '',
                        time: '',
                        hours: '',
                        ticket: '',
                        notes: '',
                        transit: 'walk',
                        transitTime: '',
                        image: '',
                        date: new Date().toISOString().split('T')[0],
                        amount: 0,
                        paymentMethod: 'cash'
                    };
                },

                saveItem() {
                    if (this.modalType === 'itinerary') {
                        this.saveItinerary();
                    } else if (this.modalType === 'shopping') {
                        this.saveShopping();
                    } else if (this.modalType === 'expense') {
                        this.saveExpense();
                    }

                    this.closeModal();
                },

                saveItinerary() {
                    const dayData = this.itineraryData[this.selectedDate];
                    if (this.editingItem) {
                        Object.assign(this.editingItem, this.formData);
                    } else {
                        const newId = Math.max(...dayData.map(i => i.id), 0) + 1;
                        dayData.push({ id: newId, ...this.formData });
                    }
                },

                saveShopping() {
                    if (this.editingItem) {
                        this.editingItem.name = this.formData.name;
                        if (this.formData.image) {
                            this.editingItem.image = this.formData.image;
                        }
                    } else {
                        const newId = Math.max(...this.shoppingList.map(i => i.id), 0) + 1;
                        this.shoppingList.push({
                            id: newId,
                            name: this.formData.name,
                            image: this.formData.image || ''
                        });
                    }
                },

                saveExpense() {
                    if (this.editingItem) {
                        Object.assign(this.editingItem, this.formData);
                    } else {
                        const newId = Math.max(...this.expenses.map(i => i.id), 0) + 1;
                        this.expenses.push({ id: newId, ...this.formData });
                    }
                },

                deleteItem(itemId) {
                    if (this.modalType === 'itinerary') {
                        const dayData = this.itineraryData[this.selectedDate];
                        const index = dayData.findIndex(i => i.id === itemId);
                        if (index > -1) dayData.splice(index, 1);
                    } else if (this.modalType === 'shopping') {
                        const index = this.shoppingList.findIndex(i => i.id === itemId);
                        if (index > -1) this.shoppingList.splice(index, 1);
                    } else if (this.modalType === 'expense') {
                        const index = this.expenses.findIndex(i => i.id === itemId);
                        if (index > -1) this.expenses.splice(index, 1);
                    }
                },

                confirmDelete() {
                    if (confirm('ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ')) {
                        this.deleteItem(this.editingItem.id);
                        this.closeModal();
                    }
                },

                closeModal() {
                    this.showModal = false;
                    this.editingItem = null;
                    this.editingIndex = -1;
                    this.resetForm();
                },

                handleImageUpload(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.formData.image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },

                copyToClipboard(item) {
                    const text = `${item.name} - ${item.time}${item.notes ? ' - ' + item.notes : ''}`;
                    navigator.clipboard.writeText(text);
                    this.showCopyToast = true;
                    setTimeout(() => {
                        this.showCopyToast = false;
                    }, 2000);
                },

                dragStart(event, index) {
                    this.draggedIndex = index;
                },

                dragDrop(event, index) {
                    event.preventDefault();
                    if (this.draggedIndex !== -1 && this.draggedIndex !== index) {
                        const dayData = this.itineraryData[this.selectedDate];
                        const draggedItem = dayData[this.draggedIndex];
                        dayData.splice(this.draggedIndex, 1);
                        dayData.splice(index, 0, draggedItem);
                    }
                },

                dragEnd() {
                    this.draggedIndex = -1;
                }
            },

            mounted() {
                // æ·»åŠ é•·æŒ‰äº‹ä»¶ç›£è½
                document.addEventListener('contextmenu', (e) => {
                    const card = e.target.closest('.itinerary-card');
                    if (card) {
                        e.preventDefault();
                    }
                });
            }
        }).mount('#app');
    </script>
</body>
</html>
